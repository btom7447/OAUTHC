import React, { useState, useRef, useEffect } from 'react';
import { Link } from 'react-router-dom';
import Navbar from './Navbar'; 
import SearchBox from './SearchBox';
import ProfileMenu from './ProfileMenu';

const Header = ({ searchQuery, setSearchQuery }) => {
  const [isProfileMenuOpen, setIsProfileMenuOpen] = useState(false);
  const profileMenuRef = useRef(null);

  const toggleProfileMenu = () => {
    setIsProfileMenuOpen(!isProfileMenuOpen);
  };

  const handleClickOutside = (event) => {
    if (profileMenuRef.current && !profileMenuRef.current.contains(event.target)) {
      setIsProfileMenuOpen(false);
    }
  };

  useEffect(() => {
    document.addEventListener("mousedown", handleClickOutside);
    return () => {
      document.removeEventListener("mousedown", handleClickOutside);
    };
  }, []);

  return (
    <header>
      <div className="first-header">
        <div className="f-header-left">
          <Link to="/Home">
            <img src="https://btom7447.github.io/OAUTH/images/oauthc-logo.png" alt="OAUTHC Logo" />
          </Link>
          <h4>
            Obafemi Awolowo University <br />
            Teaching Hospitals Complex
          </h4>
        </div>
        <div className="f-header-right">
          {/* EMERGENCY */}
          <div className="header-icons">
            <svg xmlns="http://www.w3.org/2000/svg" width="41" height="39" viewBox="0 0 41 39" fill="none">
              <path d="M24.1459 33.1262C24.7274 32.7905 25.1502 32.2347 25.3211 31.5811C25.492 30.9275 25.3972 30.2296 25.0574 29.6411L23.7761 27.4219C23.4363 26.8333 22.8794 26.4022 22.2279 26.2235C21.5764 26.0447 20.8837 26.1329 20.3021 26.4687C15.9167 29.0006 13.3542 24.5622 12.0729 22.343C10.7917 20.1238 8.22919 15.6854 12.6146 13.1535C13.1962 12.8178 13.6189 12.2619 13.7899 11.6084C13.9608 10.9548 13.8659 10.2569 13.5261 9.66835L12.2449 7.44916C11.905 6.8606 11.3481 6.42952 10.6966 6.25075C10.0451 6.07199 9.35243 6.16019 8.77089 6.49594C3.28908 9.66086 1.28125 13.779 7.6875 24.875C14.0938 35.9709 18.6641 36.2911 24.1459 33.1262Z" stroke="#005046" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
              <path d="M35.8156 23.9621C36.9804 19.4989 36.3314 14.7346 34.0113 10.716C31.6911 6.69743 27.8896 3.75324 23.442 2.53032M29.1022 22.12C29.4492 20.7945 29.5325 19.4104 29.3472 18.0469C29.162 16.6835 28.712 15.3672 28.0227 14.1735C27.3335 12.9798 26.4187 11.9319 25.3305 11.0897C24.2423 10.2476 23.002 9.62766 21.6806 9.26539M22.4248 20.2645C22.6577 19.3714 22.5278 18.4181 22.0635 17.6141C21.5993 16.81 20.8387 16.2208 19.9488 15.9759" stroke="#D34A4A" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
            </svg>
            <div>
              <h5>Inquiries</h5>
              <p>+234 815 209 2751</p>
              <p>+234 815 209 2755</p>
              <p>+234 815 209 2753</p>
            </div>
          </div>
          {/* LOCATION */}
          <div className="header-icons">
            <svg xmlns="http://www.w3.org/2000/svg" width="33" height="39" viewBox="0 0 33 39" fill="none">
              <path d="M1.6814 15.4C1.6814 29.8 16.6814 37 16.6814 37C16.6814 37 31.6814 29.8 31.6814 15.4C31.6814 7.45 24.9689 1 16.6814 1C8.3939 1 1.6814 7.45 1.6814 15.4Z" stroke="#005046" strokeWidth="2"/>
              <path d="M16.6815 20.32C19.5313 20.32 21.8415 18.0098 21.8415 15.16C21.8415 12.3102 19.5313 10 16.6815 10C13.8317 10 11.5215 12.3102 11.5215 15.16C11.5215 18.0098 13.8317 20.32 16.6815 20.32Z" stroke="#D34A4A" strokeWidth="2"/>
            </svg>
            <div>
              <h5>Location</h5>
              <p>Ilesa Road, Ife,</p>
              <p>Osun, Nigeria</p>
            </div>
          </div>
          {/* SECURITY */}
          <div className="header-icons">
            <svg xmlns="http://www.w3.org/2000/svg" width="31" height="40" viewBox="0 0 31 40" fill="none">
              <mask id="path-1-inside-1_989_7216" fill="white">
                <path d="M15.5603 39.0598C15.2235 39.0598 14.8872 39.0064 14.5665 38.9001C6.05841 36.0739 0.560547 29.3465 0.560547 21.7607V7.64409C0.560547 6.65631 1.26319 5.81132 2.23143 5.63555C6.89255 4.78752 10.9595 3.03461 14.3195 0.425425C15.0504 -0.141808 16.0707 -0.141808 16.8016 0.425425C20.1616 3.03505 24.2285 4.78796 28.8897 5.63555C29.8575 5.81132 30.5605 6.65631 30.5605 7.64409V21.7607C30.5605 29.3465 25.0631 36.0743 16.555 38.9001C16.2339 39.0064 15.8971 39.0598 15.5603 39.0598ZM15.5603 0.868101C15.3103 0.868101 15.0604 0.949259 14.8516 1.11114C11.3805 3.80669 7.1868 5.61602 2.3868 6.48966C1.83172 6.59034 1.42854 7.07598 1.42854 7.64409V21.7607C1.42854 28.9663 6.69292 35.3704 14.8403 38.0763C15.3043 38.2304 15.816 38.2304 16.2803 38.0763C24.4273 35.3708 29.6917 28.9663 29.6917 21.7607V7.64409C29.6917 7.07598 29.2885 6.59034 28.7339 6.48966C23.9343 5.61602 19.7406 3.80669 16.269 1.11114C16.0603 0.948825 15.8103 0.868101 15.5603 0.868101Z"/>
              </mask>
              <path d="M15.5603 39.0598C15.2235 39.0598 14.8872 39.0064 14.5665 38.9001C6.05841 36.0739 0.560547 29.3465 0.560547 21.7607V7.64409C0.560547 6.65631 1.26319 5.81132 2.23143 5.63555C6.89255 4.78752 10.9595 3.03461 14.3195 0.425425C15.0504 -0.141808 16.0707 -0.141808 16.8016 0.425425C20.1616 3.03505 24.2285 4.78796 28.8897 5.63555C29.8575 5.81132 30.5605 6.65631 30.5605 7.64409V21.7607C30.5605 29.3465 25.0631 36.0743 16.555 38.9001C16.2339 39.0064 15.8971 39.0598 15.5603 39.0598ZM15.5603 0.868101C15.3103 0.868101 15.0604 0.949259 14.8516 1.11114C11.3805 3.80669 7.1868 5.61602 2.3868 6.48966C1.83172 6.59034 1.42854 7.07598 1.42854 7.64409V21.7607C1.42854 28.9663 6.69292 35.3704 14.8403 38.0763C15.3043 38.2304 15.816 38.2304 16.2803 38.0763C24.4273 35.3708 29.6917 28.9663 29.6917 21.7607V7.64409C29.6917 7.07598 29.2885 6.59034 28.7339 6.48966C23.9343 5.61602 19.7406 3.80669 16.269 1.11114C16.0603 0.948825 15.8103 0.868101 15.5603 0.868101Z" fill="black"/>
              <path d="M2.30912 7.0626H2.31346V5.0626H2.30912V7.0626ZM14.5665 38.9001L13.936 40.7981L13.9371 40.7985L14.5665 38.9001ZM2.23143 5.63555L2.58866 7.60339L2.58943 7.60325L2.23143 5.63555ZM14.3195 0.425425L13.0933 -1.15454L13.0929 -1.15422L14.3195 0.425425ZM16.8016 0.425425L18.0284 -1.15413L18.0278 -1.15454L16.8016 0.425425ZM28.8897 5.63555L28.5318 7.60328L28.5323 7.60336L28.8897 5.63555ZM16.555 38.9001L17.1837 40.7987L17.1854 40.7981L16.555 38.9001ZM14.8516 1.11114L13.626 -0.469333L13.6249 -0.46849L14.8516 1.11114ZM2.3868 6.48966L2.74376 8.45754L2.74493 8.45733L2.3868 6.48966ZM14.8403 38.0763L14.2099 39.9744L14.21 39.9744L14.8403 38.0763ZM16.2803 38.0763L16.9101 39.9746L16.9107 39.9744L16.2803 38.0763ZM28.7339 6.48966L28.3757 8.45732L28.3766 8.45749L28.7339 6.48966ZM16.269 1.11114L15.0414 2.69002L15.0424 2.69084L16.269 1.11114ZM15.5603 37.0598C15.4341 37.0598 15.3105 37.0397 15.1958 37.0017L13.9371 40.7985C14.4639 40.9731 15.013 41.0598 15.5603 41.0598V37.0598ZM15.197 37.002C7.31135 34.3826 2.56055 28.2956 2.56055 21.7607H-1.43945C-1.43945 30.3974 4.80547 37.7651 13.936 40.7981L15.197 37.002ZM2.56055 21.7607V7.64409H-1.43945V21.7607H2.56055ZM2.56055 7.64409C2.56055 7.61689 2.57774 7.60537 2.58866 7.60339L1.87421 3.66771C-0.0513657 4.01727 -1.43945 5.69573 -1.43945 7.64409H2.56055ZM2.58943 7.60325C7.53058 6.70427 11.9043 4.83318 15.5462 2.00507L13.0929 -1.15422C10.0148 1.23604 6.25453 2.87077 1.87344 3.66785L2.58943 7.60325ZM15.5458 2.00539C15.5551 1.9982 15.566 1.9982 15.5753 2.00539L18.0278 -1.15454C16.5754 -2.28182 14.5457 -2.28182 13.0933 -1.15454L15.5458 2.00539ZM15.5748 2.00497C19.2167 4.8336 23.5906 6.70474 28.5318 7.60328L29.2475 3.66782C24.8665 2.87117 21.1064 1.23649 18.0284 -1.15412L15.5748 2.00497ZM28.5323 7.60336C28.5433 7.60536 28.5605 7.61728 28.5605 7.64409H32.5605C32.5605 5.69534 31.1717 4.01728 29.247 3.66774L28.5323 7.60336ZM28.5605 7.64409V21.7607H32.5605V7.64409H28.5605ZM28.5605 21.7607C28.5605 28.2957 23.81 34.3831 15.9247 37.002L17.1854 40.7981C26.3162 37.7656 32.5605 30.3973 32.5605 21.7607H28.5605ZM15.9264 37.0014C15.811 37.0396 15.6867 37.0598 15.5603 37.0598V41.0598C16.1076 41.0598 16.6567 40.9732 17.1837 40.7987L15.9264 37.0014ZM15.5603 -1.1319C14.8771 -1.1319 14.1937 -0.909528 13.626 -0.469333L16.0772 2.69161C15.9271 2.80805 15.7436 2.8681 15.5603 2.8681V-1.1319ZM13.6249 -0.46849C10.435 2.00872 6.54768 3.69949 2.02867 4.52198L2.74493 8.45733C7.82593 7.53255 12.326 5.60466 16.0783 2.69077L13.6249 -0.46849ZM2.02985 4.52177C0.513706 4.79678 -0.57146 6.11899 -0.57146 7.64409H3.42854C3.42854 8.03298 3.14974 8.3839 2.74376 8.45754L2.02985 4.52177ZM-0.57146 7.64409V21.7607H3.42854V7.64409H-0.57146ZM-0.57146 21.7607C-0.57146 30.0259 5.44971 37.0649 14.2099 39.9744L15.4707 36.1783C7.93612 33.6759 3.42854 27.9068 3.42854 21.7607H-0.57146ZM14.21 39.9744C15.0834 40.2645 16.037 40.2643 16.9101 39.9746L15.6505 36.1781C15.5949 36.1966 15.5252 36.1964 15.4707 36.1783L14.21 39.9744ZM16.9107 39.9744C25.6706 37.0653 31.6917 30.0258 31.6917 21.7607H27.6917C27.6917 27.9069 23.184 33.6763 15.65 36.1783L16.9107 39.9744ZM31.6917 21.7607V7.64409H27.6917V21.7607H31.6917ZM31.6917 7.64409C31.6917 6.1194 30.607 4.797 29.0911 4.52182L28.3766 8.45749C27.97 8.38369 27.6917 8.03257 27.6917 7.64409H31.6917ZM29.092 4.52199C24.5735 3.6995 20.6861 2.00873 17.4956 -0.468564L15.0424 2.69084C18.7951 5.60465 23.2951 7.53254 28.3757 8.45732L29.092 4.52199ZM17.4967 -0.467742C16.9264 -0.911186 16.2414 -1.1319 15.5603 -1.1319V2.8681C15.3792 2.8681 15.1942 2.80884 15.0414 2.69002L17.4967 -0.467742Z" fill="#005046" mask="url(#path-1-inside-1_989_7216)"/>
              <path d="M17.5912 28.3145C17.9454 28.11 18.2028 27.7715 18.3069 27.3735C18.411 26.9754 18.3532 26.5504 18.1463 26.192L17.366 24.8405C17.1591 24.4821 16.8199 24.2195 16.4231 24.1107C16.0264 24.0018 15.6045 24.0555 15.2503 24.26C12.5796 25.8019 11.019 23.099 10.2387 21.7475C9.45843 20.396 7.89786 17.693 10.5686 16.151C10.9228 15.9465 11.1802 15.608 11.2843 15.21C11.3884 14.8119 11.3307 14.3869 11.1237 14.0285L10.3434 12.677C10.1365 12.3186 9.79731 12.056 9.40055 11.9472C9.00378 11.8383 8.58191 11.892 8.22775 12.0965C4.8893 14.0239 3.66652 16.5319 7.56796 23.2894C11.4694 30.0469 14.2528 30.2419 17.5912 28.3145Z" stroke="#005046" strokeLinecap="round" strokeLinejoin="round"/>
              <path d="M24.6981 22.7335C25.4074 20.0153 25.0122 17.1139 23.5992 14.6665C22.1862 12.2192 19.8711 10.4261 17.1625 9.68138M20.6096 21.6116C20.8209 20.8044 20.8716 19.9615 20.7588 19.1311C20.646 18.3007 20.3719 17.4991 19.9522 16.7721C19.5324 16.0451 18.9753 15.407 18.3126 14.8941C17.6498 14.3812 16.8945 14.0037 16.0897 13.7831M16.543 20.4816C16.6848 19.9377 16.6057 19.3572 16.323 18.8675C16.0402 18.3778 15.577 18.019 15.0351 17.8698" stroke="#D34A4A" strokeLinecap="round" strokeLinejoin="round"/>
            </svg>
            <div>
              <h5>Security</h5>
              <p>+234 805 500 2174</p>
            </div>
          </div>
        </div>
      </div>
      <div className="second-header">
        <Navbar />
        <div className="nav-search">
          <SearchBox searchQuery={searchQuery} setSearchQuery={setSearchQuery} />
          <button className='profile-button' onClick={toggleProfileMenu}>
            <svg xmlns="http://www.w3.org/2000/svg" width="45" height="45" viewBox="0 0 45 45" fill="none">
              <g clipPath="url(#clip0_978_4250)">
                <path d="M22.4747 0.247314C10.1987 0.247314 0.247192 10.1988 0.247192 22.4749C0.247192 34.7509 10.1987 44.7024 22.4747 44.7024C34.7508 44.7024 44.7023 34.7509 44.7023 22.4749C44.7023 10.1988 34.7508 0.247314 22.4747 0.247314ZM22.4747 11.1176C26.8703 11.1176 30.447 14.6942 30.447 19.0898C30.447 23.486 26.8703 27.0621 22.4747 27.0621C18.0786 27.0621 14.5025 23.486 14.5025 19.0898C14.5025 14.6942 18.0786 11.1176 22.4747 11.1176ZM22.4747 41.6612C16.9746 41.6612 12.0411 39.2482 8.6655 35.4261C10.2348 32.5859 12.6882 30.2515 15.6054 28.8364C16.5978 28.3553 17.7561 28.3632 18.784 28.8566C19.9413 29.4128 21.1831 29.6944 22.4752 29.6944C23.7669 29.6944 25.0092 29.4123 26.1665 28.8566C27.1954 28.3627 28.3537 28.3553 29.345 28.8364C32.2623 30.251 34.7152 32.5859 36.2845 35.4261C32.9083 39.2478 27.9748 41.6612 22.4747 41.6612Z" fill="white"/>
              </g>
              <defs>
                <clipPath id="clip0_978_4250">
                  <rect width="45" height="45" fill="white"/>
                </clipPath>
              </defs>
            </svg>
          </button>
        </div>
       
        {isProfileMenuOpen && <ProfileMenu ref={profileMenuRef} />}
      </div>
    </header>
  );
};

export default Header;
